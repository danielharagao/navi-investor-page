<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Journey & Flow — Navi</title>
  <link href="https://fonts.googleapis.com/css?family=Inter:400,700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', Arial, sans-serif;
      background: #f8f9fa;
      color: #1a365d;
      margin: 0;
      padding: 0;
    }
    header {
      background: #1a365d;
      color: #fff;
      padding: 2rem 0 1rem 0;
      text-align: center;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }
    h2 {
      color: #00d4aa;
      margin-top: 2rem;
    }
    h3 {
      color: #ff6b6b;
      margin-top: 1.5rem;
    }
    section {
      max-width: 900px;
      margin: 2rem auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(26,54,93,0.08);
      padding: 2rem;
    }
    ul, ol {
      margin-left: 2rem;
    }
    .tagline {
      font-size: 1.2rem;
      color: #00d4aa;
      margin-bottom: 1rem;
    }
    .feature {
      margin-bottom: 1.5rem;
    }
    pre {
      background: #f8f9fa;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
      padding: 1rem;
      overflow-x: auto;
      white-space: pre-wrap;
    }
    code {
      font-family: 'Courier New', monospace;
    }
    .footer {
      text-align: center;
      color: #888;
      font-size: 0.9rem;
      margin: 2rem 0 1rem 0;
    }
    @media (max-width: 600px) {
      section {
        padding: 1rem;
      }
      h1 {
        font-size: 2rem;
      }
    }
  </style>
  <!-- Mermaid.js for rendering diagrams -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: true });</script>
</head>
<body>
  <header>
    <h1>User Journey & Flow</h1>
    <div class="tagline">Sequence Diagram</div>
    <p>Detailed user flow from discovery to paid conversion</p>
  </header>

  <section>
    <h2>Sequence Diagram</h2>
    <p>The following Mermaid sequence diagram illustrates the complete user journey from visiting the landing page to becoming a paid user.</p>

    <div class="mermaid">
sequenceDiagram
  autonumber
  actor U as User
  participant W as Website
  participant E as E-mail Service
  participant A as Desktop App
  participant B as Backend/Auth API
  participant S as Billing/Stripe

  %% Discovery & Signup on Web
  U->>W: Visita LP (Landing Page)
  W-->>U: Value prop + CTA Early Adopter
  U->>W: Preenche & envia formulário (nativo)
  W->>B: POST /leads (dados do formulário)
  B-->>W: 200 OK
  B->>E: Enviar e-mail com link de download
  E-->>U: E‑mail: "Download Page"

  %% Download & Install
  U->>W: Abre link de download
  W-->>U: Página de download (Win/macOS)
  U->>U: Baixa e instala o app
  U->>A: Abre o aplicativo

  %% App startup & token check (server-side)
  A->>B: verify_token(local_token)
  alt Token válido
    B-->>A: 200 OK (válido)
    A-->>U: Entra direto (área logada)
  else Sem token / inválido
    B-->>A: 401/invalid
    A-->>U: Solicita e‑mail
    U->>A: Informa e‑mail
    A->>B: lookup_user(email)
    alt Não existe usuário (apenas lead)
      B-->>A: not_found
      A->>B: create_user_from_lead(email)
      B-->>A: created {password_empty:true}
      A->>B: send_password_setup(email)
      B->>E: E-mail "Create Password"
      E-->>U: Link para criar senha
      U->>W: Abre página "Create Password" e define senha
      W->>B: set_password(email, new_password)
      B-->>W: OK
      U->>A: Volta ao app e informa e‑mail
      A->>B: login(email, password)
      B-->>A: token
      A->>A: Salva token (Keychain)
    else Usuário existe
      B-->>A: {password_empty?}
      alt password_empty==true
        A->>B: send_password_setup(email)
        B->>E: E-mail "Create Password"
        E-->>U: Link para criar senha
        U->>W: Define senha
        W->>B: set_password
        B-->>W: OK
        U->>A: Informa e‑mail novamente
        A->>B: login(email, password)
        B-->>A: token
        A->>A: Salva token
      else password_empty==false
        A-->>U: Solicita senha
        U->>A: Digita senha
        A->>B: login(email, password)
        B-->>A: token
        A->>A: Salva token
      end
    end
  end

  %% Paywall / Subscription
  A-->>U: Área logada básica
  A->>B: check_subscription(email)
  alt Já é pago
    B-->>A: subscription=ativa
    A-->>U: Acesso total liberado
  else Não é pago
    B-->>A: subscription=ausente
    A-->>U: Prompt: "Ativar assinatura"
    U->>A: Clica "Ativar"
    A->>S: Seleciona plano (redirect/SDK)
    U->>S: Informa dados de pagamento
    S->>B: Webhook/confirmar pagamento
    B-->>S: OK
    B-->>A: subscription=ativa
    A-->>U: Acesso total liberado
  end
    </div>

    <h2>Flow Summary</h2>
    <ol>
      <li><strong>Discovery & Signup on Web:</strong> User visits landing page, sees value proposition, fills out early adopter form, backend saves as lead and sends download email.</li>
      <li><strong>Download & Install:</strong> User clicks download link, downloads appropriate installer, installs and opens the app.</li>
      <li><strong>App Startup & Authentication:</strong> App verifies token with backend; if invalid, prompts for email and handles user creation/password setup flow.</li>
      <li><strong>Paywall/Subscription:</strong> After login, app checks subscription status; if not paid, prompts for payment via Stripe integration.</li>
    </ol>
  </section>

  <div class="footer">
    <p><a href="index.html">← Back to Strategic Hub</a> | Navi User Journey</p>
  </div>
</body>
</html></content>
<parameter name="filePath">c:\Users\daniel.aragao\Documents\Coding\mcp agents\Navi\sequence.html